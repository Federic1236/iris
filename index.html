<!DOCTYPE html>
<html lang="it">
<head>
    <meta charset="UTF-8">
    <title>Iris</title>
    <style>
        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body, html {
            width: 100%;
            height: 100%;
            overflow: hidden;
            background-color: black;
            font-family: 'Arial Black', sans-serif;
        }

        /* Video a tutto schermo */
        #bg-video {
            position: fixed;
            right: 0;
            bottom: 0;
            min-width: 100%;
            min-height: 100%;
            z-index: -1; /* Mette il video dietro a tutto */
            object-fit: cover; /* Evita distorsioni del video */
        }

        #bouncing-text {
            position: absolute;
            font-size: 6vw;
            color: white;
            text-shadow: 0 0 20px rgba(0,0,0,0.8);
            white-space: nowrap;
            user-select: none;
            will-change: transform;
            z-index: 10;
        }

        #overlay {
            position: fixed;
            inset: 0;
            background: rgba(0,0,0,0.85);
            color: white;
            display: flex;
            flex-direction: column;
            align-items: center;
            justify-content: center;
            font-size: 2rem;
            cursor: pointer;
            z-index: 1000;
            text-align: center;
        }
    </style>
</head>
<body>

    <div id="overlay">
        <h1>SISTEMA IRIS</h1>
        <p>iris per sempre</p>
    </div>

    <video id="bg-video" loop muted playsinline>
        <source src="background.mp4" type="video/mp4">
      iris Ã¨ caduta
    </video>

    <div id="bouncing-text">IRIS TI AMO TI VOGLIO BENE IRIS COME SIRI HEY SIRI YES NIGGA</div>

    <script>
        const textElement = document.getElementById('bouncing-text');
        const overlay = document.getElementById('overlay');
        const video = document.getElementById('bg-video');
        
        // --- CONFIGURAZIONE ---
        const AUDIO_FILE = 'music.mp3'; 
        const lyrics = [
            "IRIS", "SEGUI IL SEGNALE", "NON GUARDARE INDIETRO", 
            "RESTA NEL TRACCIATO", "INPUT ALTO", "OUTPUT BASSO", 
            "PASSO DOPO PASSO", "ISTRUZIONE COMPLETATA"
        ];
        
        let lyricIndex = 0;
        let audioCtx, x = 0, y = 0, dx = 6, dy = 6;

        async function init() {
            // Avvia Video
            video.play();

            // Avvia Audio Context
            audioCtx = new (window.AudioContext || window.webkitAudioContext)();
            
            try {
                const response = await fetch(AUDIO_FILE);
                const arrayBuffer = await response.arrayBuffer();
                const audioBuffer = await audioCtx.decodeAudioData(arrayBuffer);

                const source = audioCtx.createBufferSource();
                source.buffer = audioBuffer;
                source.loop = true;

                // Effetti: Reverb + Delay
                const delay = audioCtx.createDelay();
                delay.delayTime.value = 0.4;
                const feedback = audioCtx.createGain();
                feedback.gain.value = 0.4;
                const reverb = audioCtx.createConvolver();
                reverb.buffer = createReverbBuffer(2.0);

                // Connessioni
                source.connect(reverb);
                reverb.connect(delay);
                delay.connect(feedback);
                feedback.connect(delay);
                
                source.connect(audioCtx.destination);
                delay.connect(audioCtx.destination);
                reverb.connect(audioCtx.destination);

                source.start();
                animate();
            } catch (e) {
                console.error("Errore Audio:", e);
                animate();
            }
        }

        function createReverbBuffer(seconds) {
            const len = audioCtx.sampleRate * seconds;
            const buf = audioCtx.createBuffer(2, len, audioCtx.sampleRate);
            for (let i = 0; i < 2; i++) {
                let chan = buf.getChannelData(i);
                for (let j = 0; j < len; j++) {
                    chan[j] = (Math.random() * 2 - 1) * Math.pow(1 - j / len, 2);
                }
            }
            return buf;
        }

        function animate() {
            const maxX = window.innerWidth - textElement.offsetWidth;
            const maxY = window.innerHeight - textElement.offsetHeight;
            
            x += dx; 
            y += dy;

            if (x >= maxX || x <= 0) { dx *= -1; changeText(); }
            if (y >= maxY || y <= 0) { dy *= -1; changeText(); }

            textElement.style.transform = `translate(${x}px, ${y}px)`;
            requestAnimationFrame(animate);
        }

        function changeText() {
            lyricIndex = (lyricIndex + 1) % lyrics.length;
            textElement.textContent = lyrics[lyricIndex];
        }

        overlay.addEventListener('click', () => {
            overlay.style.display = 'none';
            init();
        });
    </script>
</body>
</html>
